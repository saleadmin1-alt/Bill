<script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
<script>
async function exportFromTemplate() {
  // Link RAW đúng của GitHub
  const url = "https://raw.githubusercontent.com/saleadmin1-alt/bill-template/main/template.xlsx";

  // Tải template về
  const response = await fetch(url);
  const arrayBuffer = await response.arrayBuffer();
  const wb = XLSX.read(arrayBuffer, { type: "array" });

  // Lấy sheet đầu tiên
  const ws = wb.Sheets[wb.SheetNames[0]];

  // ---- Gán dữ liệu động vào template ----
  ws["B7"] = { t: "s", v: "Khách hàng: Nguyễn Văn A" };
  ws["B8"] = { t: "s", v: "Địa chỉ: 123 Quận 3 HCM" };
  ws["E12"] = { t: "n", v: 3 };        // Số lượng
  ws["F12"] = { t: "n", v: 150000 };   // Đơn giá
  ws["G12"] = { t: "n", v: 450000 };   // Thành tiền

  // Xuất file
  XLSX.writeFile(wb, "DonHang.xlsx");
}
</script>

<button onclick="exportFromTemplate()">📥 Xuất Excel từ Template</button>
